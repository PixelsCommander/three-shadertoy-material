!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("three")):"function"==typeof define&&define.amd?define(["three"],t):"object"==typeof exports?exports.ShaderToyMaterial=t(require("three")):e.ShaderToyMaterial=t(e._)}(this,function(e){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=4)}([function(t,i){t.exports=e},function(e,t){e.exports="#define GLSLIFY 1\nattribute vec3 position;\nattribute vec2 uv;\n\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nvarying vec2 vUv;\nvoid main () {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    vUv=uv;\n}"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\nuniform vec2 iResolution;\nuniform float iTime;\nvarying vec2 vUv;\nvoid  mainImage( out vec4,  vec2 fragCoord );\nvoid main () {\n    vec4 outfrag;\n    mainImage(outfrag,iResolution*vUv);\n    gl_FragColor = outfrag;\n}"},function(e,t,i){"use strict";var n=e.exports=function(){return new RegExp("(?:"+n.line().source+")|(?:"+n.block().source+")","gm")};n.line=function(){return/(?:^|\s)\/\/(.+?)$/gm},n.block=function(){return/\/\*([\S\s]*?)\*\//gm}},function(e,t,i){"use strict";i.r(t),i.d(t,"default",function(){return f});var n=i(0),r=i(1),o=i.n(r),a=i(2),u=i.n(a),l=i(3),s=i.n(l);class f extends n.RawShaderMaterial{constructor(e,t){var i=t||{};i.aspectRatio=i.aspectRatio||2;let r=1500/i.aspectRatio;i.width=1500,i.hieght=r;let a=f.retriveUsedUniforms(e);var l=new n.Clock;super({vertexShader:o.a,fragmentShader:""}),(a.iTime||a.iTimeDelta||a.iFrame||a.iDate)&&((a.iTime||a.iTimeDelta)&&(this.clock=l),this.registerUpdate());let s=this.createUniformsObject(a,i);this.uniforms=s.prof;var c=u.a+"\n"+s.code+"\n"+e;this.fragmentShader=c}registerUpdate(){setTimeout(()=>this.update(),0)}update(){if(this.uniforms.iTime&&(this.uniforms.iTime.value=this.clock.getElapsedTime()),this.uniforms.iTimeDelta&&(this.uniforms.iTimeDelta.value=this.clock.getDelta()),this.uniforms.iFrame&&(this.uniforms.iFrame.value=this.uniforms.iFrame.value+1),this.uniforms.iDate){let e=new Date,t=e.getSeconds()+60*e.getMinutes()+3600*e.getHours();this.uniforms.iDate.value=new n.Vector4(e.getFullYear(),e.getMonth(),e.getDay(),t)}if(this.uniforms.iChannelResolution){let e=e=>{this.uniforms["iChannel"+e]&&this.uniforms["iChannel"+e].value.image&&(this.uniforms.iChannelResolution.value[e]=new n.Vector3(this.uniforms["iChannel"+e].value.image.width,this.uniforms["iChannel"+e].value.image.height))};for(let t=0;t<4;t++)e(t)}requestAnimationFrame(()=>{this.update()})}static retriveUsedUniforms(e){let t=e.replace(s()(),""),i={};return"iTime,iTimeDelta,iResolution,iFrame,iChannelTime[4],iChannelResolution,iChannel0,iChannel1,iChannel2,iChannel3,iDate,iMouse".split(",").forEach(e=>{t.includes(e)&&(i[e]=!0)}),i}createUniformsObject(e,t){let i={},r="";e.iResolution&&(i.iResolution={value:new n.Vector2(t.width,t.hieght)}),e.iTime&&(i.iTime={type:"1f",value:this.clock.getElapsedTime()},r+="uniform float iTime;\n"),e.iDate&&(i.iDate={value:new n.Vector4},r+="uniform vec4 iDate;\n"),e.iTimeDelta&&(i.iTimeDelta={type:"1f",value:this.clock.getDelta()},r+="uniform float iTimeDelta;\n"),e.iFrame&&(i.iFrame={type:"1i",value:0},r+="uniform int iFrame;\n"),e.iMouse&&(i.iMouse={value:new n.Vector4(t.width/2,t.hieght/2,t.width/2,t.hieght/2)},r+="uniform vec4 iMouse;\n");let o=this;function a(n){if(e["iChannel"+n]){let e=t.map?t.map:o.getDefaultTexture();e=Array.isArray(e)?e[n]:e,i["iChannel"+n]={type:"t",value:e},r+="uniform sampler2D "+["iChannel"+n]+";\n"}}e.iChannelResolution&&(i.iChannelResolution={type:"v3v",value:[new n.Vector3,new n.Vector3,new n.Vector3,new n.Vector3]},r+="uniform vec3 iChannelResolution[4];\n");for(let e=0;e<4;e++)a(e);return{prof:i,code:r}}getDefaultTexture(){return f.defaultTexture||(f.defaultTexture=(new n.TextureLoader).load("https://threejs.org/examples/textures/UV_Grid_Sm.jpg",()=>{this.update()})),f.defaultTexture}}}]).default});